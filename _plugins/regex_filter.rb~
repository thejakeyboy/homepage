module Jekyll



  module FindBibEntry
	
		def test(input)
			s = 'ABC'
		end
		
=begin

		non_delimiters = /[^(){}\[\]]*/
		Paired = /\(#{non_delimiters}\)|\{#{non_delimiters}\}|\[#{non_delimiters}\]/
		Delimiter = /[(){}\[\]]/
		def balanced? s # check if s is ballanced between two brackets
			s = s.dup
			s.gsub!(Paired, "".freeze) while s =~ Paired
			s !~ Delimiter
		end

    def find_bib_entry(filename, key)
		# search a bib entry based on the key
			entryfound = false;
			s = "test";
			File.open(filename) do |f|
				f.any? do |line|
					if (line.include?(key) && !entryfound)
						entryfound = true #if the key is found, be append the line
						s << line;
					end
					if entryfound
						if not balanced?(s) # if s in unbalanced in parenthesis or other, then we need to continue.
							s << line;
						else
							break;  # we are done!
						end
					end
				end
			end
			s # return
    end
=end
  end
end

Liquid::Template.register_filter(Jekyll::FindBibEntry)
